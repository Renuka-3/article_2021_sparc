---
title: "Phyloseq"
author: "Renuka"
date: "2 February 2020"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
require(knitcitations)
library(microbiome)
library(gridExtra)
library(phyloseq)
library(ggplot2)
library(dada2)
library(tidyverse)
theme_set(theme_bw(20))
opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
opts_chunk$set(dev="CairoPNG")
transform <- microbiome::transform
phy<-phyloseqsp
summarize_phyloseq(phy)
```

##Phenotype data

```{}
Number of metadata fields: 
ncol(meta(phy))  
  
  ```{r metadata_fields, echo=FALSE, message=FALSE, fig.width=10, fig.height=8, fig.show="keep", out.width="50%"}
print(sort(colnames(meta(phy))))
```

## Taxonomic data

```{r ranks, echo=FALSE, message=FALSE, fig.width=10, fig.height=8, fig.show="keep", out.width="50%"}
d <- data.frame(n = apply(tax_table(phy), 2, function (x) {length(unique(x))}))
kable(d)
```
Histogram of read counts

```{r readcounts, echo=FALSE, message=FALSE, fig.width=8, fig.height=6, fig.show="keep", out.width="50%"}
p1 <- ggplot(data.frame(n = readcount(phy)), aes(x = n)) +
  geom_histogram() +
  labs(x = "Read count (n)", y = "Frequency (n)", title = "Total read counts")
print(p1)

df <- meta(phy)
df$n <- readcount(phy)
p2 <- ggplot(df, aes(x = "diet", y = n, color = "diet")) +
  geom_boxplot() +
  scale_y_log10() + 
  labs(y = "Read count (n)", y = "diet", title = "Read counts per group")
print(p2)
```
