col = control,
shading = FALSE)
p <- plot_landscape(microbiome::transform(phy , "compositional"),
distance = "bray",
method = "PCoA",
size = 3,
col = "control",
shading = FALSE)
print(p)
View(cols)
View(col)
rm(cols)
phy
cphy
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(phyloseq)
library(microbiome)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
index <- "diversity_shannon"
theme_set(theme_bw(15))
library(microbiome)
p <- plot_landscape(microbiome::transform(cphy , "compositional"),
distance = "bray",
method = "PCoA",
size = 3,
col = "Sample",
shading = FALSE)
print(p)
knitr::opts_chunk$set(echo = TRUE)
{r alpha, message=F, echo=F, echo=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
## *Principal Coordinates Analysis (PCoA)*
* Ordination method: `r method`
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
theme_set(theme_bw(15))
library(microbiome)
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
#index <- "diversity_shannon"
p <- plot_landscape(microbiome::transform(cphy , "compositional"),
distance = "bray",
method = "PCoA",
size = 3,
col = "Sample",
shading = FALSE)
print(p)
#cols <- meta$Sample
#cols[which(cols %in% "NC")] <- "red"
#p <- plot_landscape(microbiome::transform(phy , "compositional"),
distance = "bray",
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
phy <- readRDS("data/processed/phyloseq/phy20.1.RDS")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
index <- "diversity_shannon"
# Estimate alpha diversities
A <- alpha(phy)
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = Geographical_location, y = index, fill = Geographical_location)) +
ggbeeswarm::geom_beeswarm() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Shannon Diversity",
x = "",
title = paste0("Kruskal test p=", round(pv, 2)))
print(p1)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
df$newcolumn <- (df$Sample == "NC")
View(df)
View(df)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
df$newcolumn <- (df$Sample == "NC")
df
View(df)
cphy
sample_data(cphy)
rm(cphy)
######
otu_mat    <- as.data.frame(read_excel("data/with_control/otu with control.xlsx"))
library(readxl)
######
otu_mat    <- as.data.frame(read_excel("data/with_control/otu with control.xlsx"))
tax_mat    <- as.data.frame(read_excel("data/with_control/taxa wth control.xlsx"))
tax_mat    <- as.data.frame(read_excel("data/with_control/taxa with control.xlsx"))
samples_df <- as.data.frame(read_excel("data/with_control/meta with control.xlsx"))
row.names(otu_mat) <- otu_mat$OTUU
otu_mat <- otu_mat %>% select (-OTUU)
row.names(tax_mat) <- tax_mat$OTUU
tax_mat <- tax_mat %>% select (-OTUU)
row.names(samples_df) <- samples_df$Sample
#samples_df <- samples_df %>% select (-Sample)
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
sam = sample_data(as.data.frame(samples_df))
ccphy <- phyloseq(OTU, TAX, sam)
saveRDS(phy, file = "data/with_control/controlphy.RDS")
saveRDS(phy, file = "data/with_control/phyloseq/controlphy.RDS")
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
controlphy <- readRDS("data/with_control/phyloseq/controlphy.RDS")
df$newcolumn <- (df$Sample == "NC")
sample_data(controlphy)
View(df)
controlphy
cphy
readRDS("data/with_control/phyloseq/cphy.RDS")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
cphy
df$newcolumn <- (df$Sample == "NC")
View(df)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
df$newcolumn <- (df$Sample == "NC")
View(df)
dim(df)
print(df$Sample)
cphy
na(df$Sample)
is.na(df$Sample)
nrow(df)
cphy
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
#df$newcolumn <- (df$Sample == "NC")
sample_data$control <- (sampledata$control =="NC")
sample_data$control <- (sample_data$control =="NC")
sample_data$control <- (sample_data$Sample =="NC")
sample_data$control <- (cphy$Sample =="NC")
sample_data$control <- (sample_data(cphy)$control =="NC")
sample_data(cphy)$control =="NC"
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
#df$newcolumn <- (df$Sample == "NC")
#sample_data$control <- (sampledata$control =="NC")
#sample_data(cphy)$control =="NC"
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
#df$newcolumn <- (df$Sample == "NC")
#sample_data$control <- (sampledata$control =="NC")
#sample_data(cphy)$control =="NC"
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
#df$newcolumn <- (df$Sample == "NC")
#sample_data$control <- (sampledata$control =="NC")
#sample_data(cphy)$control =="NC"
#df$newcolumn <- (df$Sample == "NC")
#sample_data$control <- (sampledata$control =="NC")
#sample_data(cphy)$control =="NC"
sample_data(cphy)$control =="NC"
sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
library(ggplot2)
library(microbiome)
library(phyloseq)
library(dada2)
library(readxl)
library(dplyr)
otu_mat    <- as.data.frame(read_excel("data/with_control/Tables_control/otu_with_control.xlsx"))
tax_mat    <- as.data.frame(read_excel("data/with_control/Tables_control/taxa_with_control.xlsx"))
samples_df <- as.data.frame(read_excel("data/with_control/Tables_control/meta_with_control.xlsx"))
row.names(otu_mat) <- otu_mat$OTUU
otu_mat <- otu_mat %>% select (-OTUU)
row.names(tax_mat) <- tax_mat$OTUU
tax_mat <- tax_mat %>% select (-OTUU)
row.names(samples_df) <- samples_df$Sample
#samples_df <- samples_df %>% select (-Sample)
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
sam = sample_data(as.data.frame(samples_df))
# Add age group information also
cphy <- phyloseq(OTU, TAX, sam)
cphy
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
#df$newcolumn <- (df$Sample == "NC")
sample_data(cphy)$control =="NC"
sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
#df$newcolumn <- (df$Sample == "NC")
sample_data(cphy)$Control <- (sample_data(cphy)$Control == "NC")
#df$newcolumn <- (df$Sample == "NC")
sample_data(cphy)$Control <- sample_data(cphy)$Control
sample_data(cphy)$control =="NC"
sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
sample_data(cphy)
View(sample_data(cphy))
#df$newcolumn <- (df$Sample == "NC")
sample_data(cphy)$Control <- sample_data(cphy)$NC
sample_data(cphy)$control =="NC"
sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
View(sample_data(cphy))
View(sample_data(cphy))
sample_data(cphy)$Control <- sample_data(cphy)
View(sample_data(cphy))
sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
sample_data(cphy)$nc <- sample_data(cphy)$Sample =="NC"
sample_data(cphy)$Control <- sample_data(cphy)$Sample =="NC"
View(sample_data(cphy))
#sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
sample_data(cphy)$Control <- sample_data(cphy)$Sample =="NC"
sample_data(cphy)
#df$newcolumn <- (df$Sample == "NC")
sample_data(cphy)$Control <- sample_data(cphy)$NC
sample_data(cphy)$control =="NC"
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
cphy <- readRDS("data/with_control/phyloseq/cphy.RDS")
#df$newcolumn <- (df$Sample == "NC")
sample_data(cphy)$Control <- sample_data(cphy)$NC
sample_data(cphy)$control =="NC"
#sample_data(cphy)$nc <- sample_data(cphy)$control =="NC"
sample_data(cphy)$Control <- sample_data(cphy)$Sample =="NC"
theme_set(theme_bw(15))
library(microbiome)
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
#index <- "diversity_shannon"
p <- plot_landscape(microbiome::transform(cphy , "compositional"),
distance = "bray",
method = "PCoA",
size = 3,
col = Control,
shading = FALSE)
sample_data(cphy)$Control <- sample_data(cphy)$Sample =="NC"
sample_data(cphy)
names( sample_data(cphy))
theme_set(theme_bw(15))
library(microbiome)
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
#index <- "diversity_shannon"
p <- plot_landscape(microbiome::transform(cphy , "compositional"),
distance = "bray",
method = "PCoA",
size = 3,
col = "Control",
shading = FALSE)
print(p)
#cols <- meta$Sample
#cols[which(cols %in% "NC")] <- "red"
#p <- plot_landscape(microbiome::transform(phy , "compositional"),
#                        distance = "bray",
#
#                      method = "PCoA",
#                        size = 3,
#                        col = control,
#                       shading = FALSE)
#sample_data(cphy)$control <- cols
