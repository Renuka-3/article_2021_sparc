p1 + legend(x= , y = 3, c("*", "**", "***"), legend.title = element_text("Stastistics"), legend.position= "right")
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
theme(legend(legend.title = element_text("Stastistics"), legend.position= "right")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
theme(legend.title = element_text("Stastistics"), legend.position= "right") +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
library(ggsignif)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
library(ggbeeswarm)
library(ggsignif)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
legend(x = age_group, y = index,legend.title = element_text("Stastistics"), legend.position= "right")
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
legend.title = element_text("Stastistics"), legend.position= "right")
legend.title = element_text("Stastistics"), legend.position= "right"
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
legend.title = element_text(Stastistics), legend.position= "right"
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
legend.title = element_text(Stastistics) + legend.position= "right"
p1 <- ggplot(df, aes(x = age_group, y = index, fill= age_group)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
library(ggbeeswarm)
library(ggsignif)
p1 <- ggplot(df, aes(x = age_group, y = index, fill=age_group)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
knitr::opts_chunk$set(echo =F)
library(ggplot2)
library(phyloseq)
library(dada2)
library(readxl)
library(dplyr)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_age/")
# Was created with: source("create_phyloseq.R")
phy<- readRDS("data/processed/phyloseq/phy20.1.RDS")
w <- sample_data(phy)$age_group <- cut(meta(phy)$Age, breaks = c(0, 40, 59, Inf), labels = c("adult", "middle_age", "elderly"))
library(microbiome)
opts_chunk$set(dev="CairoPNG")
# Estimate alpha diversities
A <- alpha(phy)
index <- "diversity_shannon"
c <- meta(phy)
c2 <- bind_cols(c,A)
is.data.frame(c)
is.data.frame(c2)
i <- sapply(split(c2$diversity_shannon, c2$age_group), mean)
o <- sapply(split(c2$diversity_shannon, c2$age_group), sd)
y <- cbind(i,o)
#c <- round(100 * sapply(split(c2$diversity_shannon, c2$age_group), mean),2)
kable(y)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
library(ggsignif)
p1 <- ggplot(df, aes(x = age_group, y = index, fill=age_group)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot(fill=age_group) +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index, fill(age_group))) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
library(ggsignif)
jpeg(file= "figure_location.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot(color = "black") +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location") +
geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
map_signif_level = TRUE)
print(p1)
#dev.off()
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik"), c("Ahmednagar", "Pune"), c("Nashik", "Pune")),
#map_signif_level = TRUE)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
library(ggsignif)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE) +
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index, fill=bage_group)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index, fill=age_group)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() + legend(x = NULL, y= Null, legend.position = "right", title = element_text(Stastistics)) +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() + legend(legend.position = "right", title = element_text(Stastistics)) +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() + theme(legend.position="top") +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() + theme(legend.position="top", legend.title = element_text("Stats")) +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() + theme(legend.position="top", legend.title = element_text("Stats"), fill("**-0.05")) +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +
scale_x_discrete(limits = c("adult", "middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly")) +
labs(y = "Shannon Diversity", x = "", title = "Age") +
geom_signif(comparisons = list(c("adult", "middle_age", "elderly")), map_signif_level = TRUE)
knitr::opts_chunk$set(echo =F)
library(ggplot2)
library(phyloseq)
library(dada2)
library(readxl)
library(dplyr)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_age/")
# Was created with: source("create_phyloseq.R")
phy<- readRDS("data/processed/phyloseq/phy20.1.RDS")
w <- sample_data(phy)$age_group <- cut(meta(phy)$Age, breaks = c(0, 40, 59, Inf), labels = c("adult", "middle_age", "elderly"))
manpage
manpage?
manpage(boxplot())
?manpage
print(p1)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
library(ggsignif)
jpeg(file= "figure_location.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot(color = "black") +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location") +
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
map_signif_level = TRUE)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot(color = "black") +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location") +
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot(color = "black") +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location")
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = Diet, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.05) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("Mixed", "Veg"),
labels = c("Mixed", "Vegetarian")) +theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Diet") #+ geom_signif(comparisons = list(c("Mixed", "Veg")), map_signif_level = TRUE)
print(p1)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
library(microbiome)
library(microbiome)
library(phyloseq)
library(vegan)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_location/")
opts_chunk$set(dev="CairoPNG")
# Was created with: source("create_phyloseq.R")
phy <- readRDS("data/processed/phyloseq/phy20.1.RDS")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
index <- "diversity_shannon"
# Estimate alpha diversities
A <- alpha(phy)
b <- meta(phy)
b2 <- bind_cols(b,A)
is.data.frame(b)
is.data.frame(b2)
z<- sapply(split(b2$diversity_shannon, b2$Geographical_location), mean)
f <- sapply(split(b2$diversity_shannon, b2$Geographical_location), sd)
v <- cbind(z,f)
kable(v)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
library(ggsignif)
jpeg(file= "figure_location.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot(color = "black") +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location")
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),map_signif_level = TRUE)
print(p1)
#dev.off()
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik"), c("Ahmednagar", "Pune"), c("Nashik", "Pune")),
#map_signif_level = TRUE)
#geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),map_signif_level = TRUE)
print(p1)
sp <- aggregate_taxa(phy, "genus")
core.taxa <- core_members(microbiome::transform(sp, "compositional"), detection = 0.1/100, prevalence=20/100) # FOcus on core tzxa
sp <- microbiome::transform(sp, "clr")
sp.comp <- microbiome::transform(microbiome::transform(sp, "shift", shift=1), "compositional")
# Statistical testing done here at CLR abundances and filtering out rare taxa
pvs <- sapply(core.taxa, function (i) {kruskal.test(abundances(sp)[i,] ~ meta(sp)[, "Geographical_location"])$p.value})
padj <- p.adjust(pvs, method = "fdr")
toptaxa <- names(which(padj < 0.05))
# Visualization done for compositional data for intuitive presentation
theme_set(theme_bw(20))
# Just pick the top taza for visu
df <- psmelt(prune_taxa(toptaxa, sp.comp))
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
coord_flip() +
scale_y_log10(label = scales::percent)
print(p)
print(p)
sp <- aggregate_taxa(phy, "genus")
core.taxa <- core_members(microbiome::transform(sp, "compositional"), detection = 0.1/100, prevalence=20/100) # FOcus on core tzxa
sp <- microbiome::transform(sp, "clr")
sp.comp <- microbiome::transform(microbiome::transform(sp, "shift", shift=1), "compositional")
# Statistical testing done here at CLR abundances and filtering out rare taxa
pvs <- sapply(core.taxa, function (i) {kruskal.test(abundances(sp)[i,] ~ meta(sp)[, "Geographical_location"])$p.value})
padj <- p.adjust(pvs, method = "fdr")
toptaxa <- names(which(padj < 0.05))
# Visualization done for compositional data for intuitive presentation
theme_set(theme_bw(20))
# Just pick the top taza for visu
df <- psmelt(prune_taxa(toptaxa, sp.comp))
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
#coord_flip() +
scale_y_log10(label = scales::percent)
print(p)
print(p)
print(p)
sp <- aggregate_taxa(phy, "genus")
core.taxa <- core_members(microbiome::transform(sp, "compositional"), detection = 0.1/100, prevalence=20/100) # FOcus on core tzxa
sp <- microbiome::transform(sp, "clr")
sp.comp <- microbiome::transform(microbiome::transform(sp, "shift", shift=1), "compositional")
# Statistical testing done here at CLR abundances and filtering out rare taxa
pvs <- sapply(core.taxa, function (i) {kruskal.test(abundances(sp)[i,] ~ meta(sp)[, "Geographical_location"])$p.value})
padj <- p.adjust(pvs, method = "fdr")
toptaxa <- names(which(padj < 0.05))
# Visualization done for compositional data for intuitive presentation
theme_set(theme_bw(20))
# Just pick the top taza for visu
df <- psmelt(prune_taxa(toptaxa, sp.comp))
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
coord_flip() +
scale_y_log10(label = scales::percent)
print(p)
print(p)
print(p)
# Just pick the top taza for visu
df <- psmelt(prune_taxa(toptaxa, sp.comp))
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
coord_flip() #+
#scale_y_log10(label = scales::percent)
print(p)
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
coord_flip() +
scale_y_log10(label = scales::percent)
print(p)
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
coord_flip() +
scale_y_continuous(label = scales::percent) #scale_y_log10(label = scales::percent)
print(p)
p
p
p <- ggplot(df, aes(x = genus, y = Abundance,
fill = Geographical_location))+
labs(y = "Relative abundance (%)", x = '') +
geom_boxplot(outlier.shape = NA) +
coord_flip() +
scale_y_log10(label = scales::percent) #scale_y_continuous(label = scales::percent)
print(p)
