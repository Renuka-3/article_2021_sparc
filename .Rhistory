#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =b.core) %>% arrange(abundances)
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =x) %>% arrange(abundances)
bs$Var1 <- rownames(bs)
sorted.names <- rownames(bs)
bs$Var1 <- factor(bs$Var1, levels=sorted.names)
#bs$Var2 <- factor(bs$Var2, levels = rev(d$Taxon))
#bs$Var3 = str_wrap(bs$Var2, width =30)
bs$Var1 <- gsub(bs$Var1, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
p4 <- ggplot(bs, aes(x = Var1, y = abundances)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
#scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p4)
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =x) %>% arrange(abundances)
bs$Var1 <- rownames(bs)
sorted.names <- rownames(bs)
bs$Var1 <- factor(bs$Var1, levels=sorted.names)
#bs$Var2 <- factor(bs$Var2, levels = rev(d$Taxon))
#bs$Var3 = str_wrap(bs$Var2, width =30)
bs$Var1 <- gsub(bs$Var1, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
p4 <- ggplot(bs, aes(x = Var1, y = abundances)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
#scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p4)
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =x) %>% arrange(abundances)
bs$Var1 <- rownames(bs)
sorted.names <- rownames(bs)
bs$Var1 <- factor(bs$Var1, levels=sorted.names)
#bs$Var2 <- factor(bs$Var2, levels = rev(d$Taxon))
#bs$Var3 = str_wrap(bs$Var2, width =30)
bs$Var1 <- gsub(bs$Var1, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
p4 <- ggplot(bs, aes(x = Var1, y = abundances)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
#scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p4)
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
x <- prevalence(b.core)
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =x) %>% arrange(abundances)
bs$Var1 <- rownames(bs)
sorted.names <- rownames(bs)
bs$Var1 <- factor(bs$Var1, levels=sorted.names)
#bs$Var2 <- factor(bs$Var2, levels = rev(d$Taxon))
#bs$Var3 = str_wrap(bs$Var2, width =30)
bs$Var1 <- gsub(bs$Var1, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
p4 <- ggplot(bs, aes(x = Var1, y = abundances)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
#scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p4)
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
x <- prevalence(b.core)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =x) %>% arrange(abundances)
bs$Var1 <- rownames(bs)
sorted.names <- rownames(bs)
bs$Var1 <- factor(bs$Var1, levels=sorted.names)
#bs$Var2 <- factor(bs$Var2, levels = rev(d$Taxon))
#bs$Var3 = str_wrap(bs$Var2, width =30)
bs$Var1 <- gsub(bs$Var1, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
p4 <- ggplot(bs, aes(x = Var1, y = abundances)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
#scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p4)
theme_set(theme_bw(base_size = 20))
library(knitr)
require(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
core_detection <- .1/100
core_prevalence <- 50/100
# Was created with: source("create_phyloseq.R")
phy20.1 <- readRDS("data/processed/phyloseq/phy20.1.RDS")
ps <- aggregate_taxa(phy20.1, "genus")
ps <- microbiome::transform(ps, "compositional")
ps.core <- core(ps, detection = core_detection, prevalence = core_prevalence)
m <- round(100 * rowMeans(abundances(ps.core)), 1)
median <- round(100 * apply(abundances(ps.core), 1, median), 1)
prev <- round(100 * prevalence(ps.core, detection = core_detection), 1)
d <- as.data.frame(list(Taxon = names(m), Abundance_mean = m, Abundance_median = median, Prevalence = prev))
rownames(d) <- NULL
d <- d %>% arrange(desc(Abundance_mean), desc(Prevalence))
colnames(d) <- c("Taxon", "Mean Relative abundance (%)", "Median Relative abundance (%)", "Prevalence (%)")
kable(d)
theme_set(theme_bw(base_size = 13))
dfm <- melt(abundances(ps.core))
dfm$Var1 <- factor(dfm$Var1, levels = rev(d$Taxon))
dfm$Var_new = str_wrap(dfm$Var1, width = 40)
p2 <- ggplot(dfm, aes(x = Var_new, y = value)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p2)
ps <- aggregate_taxa(phy20.1, "phylum")
ps <- microbiome::transform(ps, "compositional")
ps.core <- core(ps, detection = core_detection, prevalence = core_prevalence)
m <- round(100 * rowMeans(abundances(ps.core)), 1)
#median <- round(100 * apply(abundances(ps.core), 1, median), 1)
prev <- round(100 * prevalence(ps.core, detection = core_detection), 1)
d <- as.data.frame(list(Taxon = names(m), Abundance_mean = m, Prevalence = prev))
rownames(d) <- NULL
d <- d %>% arrange(desc(Abundance_mean), desc(Prevalence))
colnames(d) <- c("Taxon", "Mean Relative abundance (%)", "Prevalence (%)")
kable(d)
library(knitr)
a <- aggregate_taxa(phy20.1, level = "genus")
xc <- abundances(transform(a, "compositional"))
df <- melt(xc)
names(df) <- c("Genus", "sample", "value")
dfm <- df %>% group_by(Genus) %>%
summarise(mean = round(100 * mean(value), 1),
#median = round(100 * median(value), 1),
#min = round(100 * min(value), 1),
#max = round(100 * max(value), 1),
prevalence = round(100 * prevalence(value), 1))%>%
arrange(desc(mean))
#kable(dfm)
#write.csv(dfm, file="genus table.csv")
library(data.table)
a <- data.table:::print.data.table(dfm, nrows = 18, topn=18)
theme_set(theme_bw(base_size = 18))
core_detection1 <- .1/100
core_prevalence <- 20/100
b <- aggregate_taxa(phy20.1, "genus")
b <- microbiome::transform(b, "compositional")
b.core <- core(b, detection = core_detection1, prevalence = core_prevalence)
x <- prevalence(b.core)
bs <- melt(abundances(b.core))
bs <- data.frame(abundances =x) %>% arrange(abundances)
bs$Var1 <- rownames(bs)
sorted.names <- rownames(bs)
bs$Var1 <- factor(bs$Var1, levels=sorted.names)
#bs$Var2 <- factor(bs$Var2, levels = rev(d$Taxon))
#bs$Var3 = str_wrap(bs$Var2, width =30)
bs$Var1 <- gsub(bs$Var1, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
p4 <- ggplot(bs, aes(x = Var1, y = abundances)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
#scale_y_log10(label = scales::percent) +
coord_flip() + theme(legend.position="none") +
labs(y = "Relative abundance (%)", x = '', title = "Core abundance variation")
print(p4)
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
ren <- as.data.frame(df$Genus)
ren <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = ren, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
ren <- as.data.frame(df$Genus)
ren <- gsub(ren, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = ren, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
#df$Genus <- factor(df$Genus, levels=sorted.names)
ggplot(df, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
ren <- as.data.frame(df$Genus)
ren
df
ren <- as.data.frame(df)
ggplot(df, aes(x = ren, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
ggplot(ren, aes(x = Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
ren
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
ren <- as.data.frame(df)
ggplot(ren, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
df$Genus <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
ren <- as.data.frame(df)
ggplot(ren, aes(x = df$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
se <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
se
ren <- as.data.frame(df)
renn <- c(se,ren)
renn
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
df$Genus <- factor(df$Genus, levels=sorted.names)
se <- gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium")
ren <- as.data.frame(df)
renn <- c(se,ren)
ggplot(renn, aes(x = Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
renn <- as.dataf.frame(c(se,ren))
renn <- as.dataf.frame(ren)
renn <- as.data.frame(ren)
de <- merge.data.frame(renn, se)
de
#renn <- as.data.frame(ren)
de <- merge.data.frame(ren, se)
de
ggplot(de, aes(x = Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
rm(renn)
po <- as.data.frame(se)
de <- merge.data.frame(ren, po)
de
ggplot(de, aes(x = Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
ggplot(po, aes(x = Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
ggplot(de, aes(x = Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
se <- as.data.frame(gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium"))
se
#po <- as.data.frame(se)
de <- merge.data.frame(ren, se)
de
#sorted.names <- sort(rownames(df)) # Alphabetic order
ren <- as.data.frame(df)
ren <- factor(df$Genus, levels=sorted.names)
ren
se <- as.data.frame(gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium"))
se
rm(po)
po <- cbind(ren,se)
po
dim(po)
dim(df)
df
bt <- cbind(po,df)
dim(bt)
bt
ct <- as.data.frame(bt)
ct <- as.data.frame(bt)
#de <- merge.data.frame(ren, se)
ggplot(ct, aes(x = ct$gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium"), y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
#de <- merge.data.frame(ren, se)
ggplot(ct, aes(x = ct$Genus, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
colnames(bt)
colnames(ct)
#de <- merge.data.frame(ren, se)
ggplot(ct, aes(x = ct$gsub, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
ct
ren
#sorted.names <- sort(rownames(df)) # Alphabetic order
ren <- as.data.frame(df)
ren <- factor(df$Genus, levels=sorted.names)
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
ren <- as.data.frame(df)
ren <- factor(df$Genus, levels=sorted.names)
se <- as.data.frame(gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium"))
po <- cbind(ren,se)
bt <- cbind(po,df)
ct <- as.data.frame(bt)
ggplot(ct, aes(x = ct$gsub, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
g <- ggplot(ct, aes(x = ct$gsub, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
print(g)
grid.arrange(p4,g, nrow=1)
library(ggplot2)
grid.arrange(p4,g, nrow=1)
library("gridExtra")
grid.arrange(p4,g, nrow=1)
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
ren <- as.data.frame(df)
ren <- factor(df$Genus, levels=sorted.names)
se <- as.data.frame(gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium"))
po <- cbind(ren,se)
bt <- cbind(po,df)
ct <- as.data.frame(bt)
g <- ggplot(ct, aes(x = ct$gsub, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
print(g)
library("gridExtra")
grid.arrange(p4,g, nrow=1)
theme_set(theme_bw(base_size = 20))
#sorted.names <- c("Acinetobacter", "Aeromonas", "Anaerococcus", "Arthrobacter", "Bacillus", "Brevibacillus", "Brevibacterium", "Clostridium", "Corynebacterium", "Enterobacter", "Exiguobacterium", "Geobacillus", "Intestinimonas", "Micrococcus", "Moraxella", "Oceanobacillus", "Paenibacillus", "Pantoea", "Propionibacterium", "Pseudomonas", "Salmonella" ,"Staphylococcus", "Thiolamprovum", "Virgibacillus")
x <- prevalence(b.core)
df <- data.frame(prevalence = x) %>% arrange(prevalence) # Also sort by prevalence
df$Genus <- rownames(df)
sorted.names <- rownames(df) # Use the same order than in prevalences that were now sorted by magnitude
#sorted.names <- sort(rownames(df)) # Alphabetic order
ren <- as.data.frame(df)
ren <- factor(df$Genus, levels=sorted.names)
se <- as.data.frame(gsub(df$Genus, pattern = "Propionibacterium", replacement = "Propionibacterium/Cutibacterium"))
po <- cbind(ren,se)
bt <- cbind(po,df)
ct <- as.data.frame(bt)
g <- ggplot(ct, aes(x = ct$gsub, y = prevalence)) +
geom_bar(stat = "identity") +
coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +
labs(y = "Prevalence (%)", x = 'Genus', title = "Core prevalence variation")
print(g)
library("gridExtra")
grid.arrange(p4,g, nrow=1)
