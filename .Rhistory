title = "Diet") + geom_signif(comparisons = list(c("Mixed", "Veg")),
map_signif_level = TRUE)
print(p1)
dev.off()
print(p1)
dev.off()
print(p1)
theme_set(theme_bw(base_size = 25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- wilcox.test(data = df, index ~ factor(Diet))$p.value
wilcox.test(data = df, index ~factor(Diet))
library(ggbeeswarm)
#tiff(file = "figure_diet.pdf/", res=300)
p1 <- ggplot(df, aes(x = Diet, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.05) +
theme(axis.text.x = element_text(angle = 0, hjust = 1),axis.title.x = element_text()) +scale_x_discrete(limits = c("Mixed", "Veg"),
labels = c("Mixed", "Vegetarian")) +theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Diet") + geom_signif(comparisons = list(c("Mixed", "Veg")),
map_signif_level = TRUE)
print(p1)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location")
print(p1)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 20, hjust = 1)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location") + geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
map_signif_level = TRUE)
print(p1)
print(p1)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
+        geom_boxplot() +
+        geom_jitter(width = 0.1) +
+         theme(axis.text.x = element_text(angle = 20, hjust = 0.5)) + theme(legend.position = "none")+
+         labs(y = "Shannon Diversity",
+ 	     x = "",
+ 	     title = "Geographical location") + geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
+     map_signif_level = TRUE)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 20, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location") + geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
map_signif_level = TRUE)
print(p1)
print(p1)
theme_set(theme_bw(base_size=25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(Geographical_location))$p.value
kruskal.test(data = df, index ~factor(Geographical_location))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Geographical location") + geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
map_signif_level = TRUE)
print(p1)
p1 <- ggplot(df, aes(x = Geographical_location, y = index)) +
+        geom_boxplot() +
+        geom_jitter(width = 0.1) +
+         theme(axis.text.x = element_text(angle = 20, hjust = 0.5)) + theme(legend.position = "none")+
+         labs(y = "Shannon Diversity",
+ 	     x = "",
+ 	     title = "Geographical location") + geom_signif(comparisons = list(c("Ahmednagar", "Nashik", "Pune")),
+     map_signif_level = TRUE)
print(p1)
theme_set(theme_bw(base_size = 25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- wilcox.test(data = df, index ~ factor(Diet))$p.value
wilcox.test(data = df, index ~factor(Diet))
library(ggbeeswarm)
#tiff(file = "figure_diet.pdf/", res=300)
p1 <- ggplot(df, aes(x = Diet, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.05) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("Mixed", "Veg"),
labels = c("Mixed", "Vegetarian")) +theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Diet") + geom_signif(comparisons = list(c("Mixed", "Veg")),
map_signif_level = TRUE)
print(p1)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 1)) +theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Age group")
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + axis.title.x = element_text() +scale_x_discrete(limits = c("adult", "Middle_age", "elderly"),
labels = c("Adult", "Middle age", "Elderly"))+ theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Age group")
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + axis.title.x = element_text() +scale_x_discrete(limits = c("adult", "Middle_age","elderly"),
labels = c("Adult", "Middle age", "Elderly"))+ theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Age group")
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + axis.title.x = element_text() + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "Middle_age", "elderly" )),
map_signif_level = TRUE)
knitr::opts_chunk$set(echo =F)
library(ggplot2)
library(phyloseq)
library(dada2)
library(readxl)
library(dplyr)
library(knitr)
library(knitcitations)
library(microbiome)
library(phyloseq)
library(ggplot2)
library(reshape2)
library(tidyverse)
library(dada2)
library(dplyr)
theme_set(theme_bw(20))
knitr::opts_chunk$set(fig.width=10, fig.height=10, message=FALSE, warning=FALSE)
knitr::opts_chunk$set(fig.path="figure_age/")
# Was created with: source("create_phyloseq.R")
phy<- readRDS("data/processed/phyloseq/phy20.1.RDS")
w <- sample_data(phy)$age_group <- cut(meta(phy)$Age, breaks = c(0, 40, 59, Inf), labels = c("adult", "middle_age", "elderly"))
library(microbiome)
opts_chunk$set(dev="CairoPNG")
# Estimate alpha diversities
A <- alpha(phy)
index <- "diversity_shannon"
c <- meta(phy)
c2 <- bind_cols(c,A)
is.data.frame(c)
is.data.frame(c2)
i <- sapply(split(c2$diversity_shannon, c2$age_group), mean)
o <- sapply(split(c2$diversity_shannon, c2$age_group), sd)
j <- cbind(i,o)
kable(j)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + axis.title.x = element_text() + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "Middle_age", "elderly" )),
map_signif_level = TRUE)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "Middle_age", "elderly" )),
map_signif_level = TRUE)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "Middle_age", "elderly")),
map_signif_level = TRUE)
print(p1)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
print(p1)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("adult", "middle_age","elderly"),
labels = c("Adult","Middle age","Elderly" )) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
print(p1)
print(p1)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("adult", "middle_age","elderly"),
labels = c("Adult","Middle age","Elderly" )) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
print(p1)
print(p1)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
pdf(file= "figure_age.pdf", res= 300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
pdf(file= "figure_age.pdf", res=300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
pdf(file= "figure_age.pdf")
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("adult", "middle_age","elderly"),
labels = c("Adult","Middle age","Elderly" )) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
#print(p1)
dev.off()
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file.path(figure_age.pdf), quality = 300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file.path(p1.pdf), quality = 300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file.path(figure_age.jpeg), quality = 300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file.path= "figure_age.jpeg"), quality = 300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file= "figure_age.jpeg"), quality = 300)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file= "figure_age.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("adult", "middle_age","elderly"),
labels = c("Adult","Middle age","Elderly" )) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
#print(p1)
dev.off()
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file= "figure_age.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("adult", "middle_age","elderly"),
labels = c("Adult","Middle age","Elderly" )) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
print(p1)
dev.off()
theme_set(theme_bw(base_size = 25))
library(Cairo)
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- wilcox.test(data = df, index ~ factor(Diet))$p.value
wilcox.test(data = df, index ~factor(Diet))
library(ggbeeswarm)
library(ggsignif)
jpeg(file= "figure_diet.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = Diet, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.05) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("Mixed", "Veg"),
labels = c("Mixed", "Vegetarian")) +theme(legend.position = "none")+
labs(y = "Shannon Diversity",
x = "",
title = "Diet") + geom_signif(comparisons = list(c("Mixed", "Veg")),
map_signif_level = TRUE)
print(p1)
dev.off()
print(p1)
print(p1)
library(Cairo)
theme_set(theme_bw(base_size=25))
df <- meta(phy)
df <- bind_cols(df, A)
df$index <- df[[index]]
pv <- kruskal.test(data = df, index ~ factor(age_group))$p.value
kruskal.test(data = df, index ~ factor(age_group))
library(ggbeeswarm)
jpeg(file= "figure_age.jpeg", quality = 300)
p1 <- ggplot(df, aes(x = age_group, y = index)) +
geom_boxplot() +
geom_jitter(width = 0.1) +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),axis.title.x = element_text()) +scale_x_discrete(limits = c("adult", "middle_age","elderly"),
labels = c("Adult","Middle age","Elderly" )) + theme(legend.position = "none") +
labs(y = "Shannon Diversity",
x = "",
title = "Age group")+ geom_signif(comparisons = list(c("adult", "middle_age", "elderly")),
map_signif_level = TRUE)
print(p1)
dev.off()
print(p1)
knitr::knit("age.Rmd", input = "age.md")
knitr::knit("age.md")
knit("age.md")
```
## [1] TRUE
```
